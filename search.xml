<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>VB动态数组Redim实测</title>
      <link href="/2018/06/17/VB%E7%9A%84%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84/"/>
      <url>/2018/06/17/VB%E7%9A%84%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84/</url>
      <content type="html"><![CDATA[<p><div class="aplayer" data-id="1690727" data-server="netease" data-type="song" data-autoplay="true"></div><br>最近碰到个问题一定要用VB来处理字典嵌套动态数组解决，于是我百度“VBA动态数组”点击第一个结果并学习了来自CSDN大神的带秀操作。<br><img src="\img\csdn.png" alt="csdn"><br>看上去很简单嘛写个demo测试一下</p><pre><code>Sub test()    Dim kh As Dictionary    lr = Range(&quot;R9999&quot;).End(xlUp).Row    Set kh = CreateObject(&quot;Scripting.Dictionary&quot;)    For i = 2 To lr        mq = Range(&quot;R&quot; &amp; i).Value        sz = Range(&quot;U&quot; &amp; i).Value        If kh.Exists(mq) = False Then            kh(mq) = Array(sz)        Else            For j = 0 To UBound(kh(mq))                If kh(mq)(j) = sz Then                    flag = True                    Exit For                End If            Next j            If flag = False And sz &lt;&gt; &quot;&quot; Then                k = UBound(kh(mq))                Dim cup()                cup = kh(mq)                                    ReDim Preserve cup(k + 2)                                    cup(k + 2) = sz                kh(mq) = cup            End If            flag = False        End If    Next i    For Each Key In kh.Keys        Debug.Print Key, UBound(kh(Key)), Join(kh(Key), &quot;;&quot;)    NextEnd Sub</code></pre><p>我设置k是动态数组的上界，那么每次迭代之前的数组长度是k+1，因为数组都是从0开始编号的嘛。大神说重新声明时括号里要填上长度，那我迭代之后需要的长度比原来多1，就是k+2咯，没有任何毛病。打印出来看下结果：</p><pre><code>4164/332    6          40;;41;;42;;434186/332    2          39;;425201/331-1  2        39;;415203/331-1  4        37;;38;;395203/331-2  0        365358/331-1  8        37;;38;;39;;40;;415358/331-2  2        35;;36</code></pre><p>第二列是每个动态数组最终的上界，第三列怎么这么多空值呢？规律是从第二个开始每隔一个数就会加一个空值，看来还是这个Redim重新设定数组长度的时候出错了，我把它改成k+1试试？打印一下：</p><pre><code>4164/332    3          40;41;42;434186/332    1          39;425201/331-1  1        39;415203/331-1  2        37;38;395203/331-2  0        365358/331-1  4        37;38;39;40;415358/331-2  1        35;36</code></pre><p>Redim数组时括号中的数字表示的是重新定义后的上界数值，认为它是数组长度(和Dim一样)是想当然了。这位CSDN老哥还用两个例子试了一下证明自己是对的，你倒是把上界打印一下啊，你数组后面多了一个空值你知道不？最骚的是百度出来它还排在第一位，这老哥得误导多少人啊。震惊之余我在微软的官网搜索了一哈，哦原来人家写的明明白白，打扰了。（还提醒了你不要犯这样滴错误哟）<br><img src="\img\ms.png" alt="ms"><br>这个故事告诉我们学好英语是多么的重要。。。我开玩笑的，我其实是想说人生苦短，我用Python。</p>]]></content>
      
      
        <tags>
            
            <tag> VB </tag>
            
            <tag> Redim </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Markdown语法练习</title>
      <link href="/2018/06/14/markdown%20practice/"/>
      <url>/2018/06/14/markdown%20practice/</url>
      <content type="html"><![CDATA[<div class="aplayer" data-id="29732992" data-server="netease" data-type="song" data-autoplay="true"></div><h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1><h4 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h4><ul><li>水果<ul><li>香蕉</li><li>梨</li></ul></li><li>蔬菜<ul><li>黄瓜<h4 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h4></li></ul></li></ul><ol><li>水果<ol><li>苹果</li></ol></li><li>蔬菜</li></ol><blockquote><p>黑夜给了我黑色的眼睛 –顾城</p></blockquote><p><em>这是斜体</em></p><p><strong>这是粗体</strong></p><p><a href="www.baidu.com">百度</a></p><hr><p>下一段</p><table><thead><tr><th style="text-align:center">火箭</th><th style="text-align:center">勇士</th></tr></thead><tbody><tr><td style="text-align:center">哈登</td><td style="text-align:center">库里</td></tr></tbody></table>]]></content>
      
      
        <tags>
            
            <tag> 测试 </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
